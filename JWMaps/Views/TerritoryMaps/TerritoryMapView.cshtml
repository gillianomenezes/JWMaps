@model List<JWMaps.Models.Householder>

@{
    ViewBag.Title = "TerritoryMapView";
}

<h2>TerritoryMapView</h2>

<table id="householders" class="table table-bordered table-hover">
    <thead>
        <tr>
            <th>Name</th>
            <th>Address</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var householder in Model)
        {
            <tr>
                <td>@Html.ActionLink(householder.Name, "Edit", "Householders", new { id = householder.Id }, null)</td>
                <td>@householder.Address</td>
            </tr>
        }
    </tbody>
</table>

<div id="map" style="width: 95%; height: 432px" />


@section scripts
{
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCDXPe6iLZmeOYItmk84ZuV7wVJ_vSQQQs&sensor=false"></script>
    <script type="text/javascript" language="javascript">
        $(document).ready(function () {
            $("#householders").DataTable();

            function initMap() {

                var latlng = new google.maps.LatLng(@Model.First().Latitude, @Model.First().Longitude);

                var mapOptions = {
                    zoom: 14,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };

                var map = new google.maps.Map(document.getElementById("map"), mapOptions);

                for(int i = 0 ; i < @Model.Count ; i++)
                {
                    var myLatlng = google.maps.LatLng(@Model[i].Latitude, @Model[i].Longitude);
                    var marker = new google.maps.Marker({
                        position: myLatlng,
                        title: "Hello World!"});
                    
                    marker.setMap(map);
                }

            } google.maps.event.addDomListener(window, 'load', initMap);
        })
    </script>

}

