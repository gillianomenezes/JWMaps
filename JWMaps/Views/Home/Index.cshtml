@model JWMaps.ViewModel.DashboardViewModel
@{
    ViewBag.Title = "Home Page";
}

<div>
    <div id="map" class="jumbotron" style="width: 95%; height: 432px" />

    <div>
        <ul>
            <li><strong>Total de endereços:</strong> @Model.Householders.Count</li>
            <li><strong>Total de estudantes:</strong> @Model.Householders.Count(h => h.PublisherId != null)</li>
        </ul>
    </div>
</div>

@section scripts
{
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCDXPe6iLZmeOYItmk84ZuV7wVJ_vSQQQs&sensor=false"></script>
    <script type="text/javascript" language="javascript">
        $(document).ready(function () {

            function initMap() {
                
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 17
                });

                var bounds = new google.maps.LatLngBounds();

                @foreach(var householder in Model.Householders)
                {
                    <text>

                    var marker = new google.maps.Marker({
                        position: new google.maps.LatLng(@householder.Latitude.ToString().Replace(',', '.') , @householder.Longitude.ToString().Replace(',', '.')),
                        map: map
                        });

                    bounds.extend(marker.getPosition());

                    </text>
                }

                map.fitBounds(bounds);

            } google.maps.event.addDomListener(window, 'load', initMap);
        })
    </script>
}